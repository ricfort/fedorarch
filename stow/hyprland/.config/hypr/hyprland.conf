# Monitor configuration - uses preferred resolution
# Source external monitor configuration
source = ~/.config/hypr/monitors.conf

# Source user-specific settings (ignored by git if you wish)
source = ~/.config/hypr/user.conf

# Source current theme
source = ~/.config/hypr/theme.conf

input {
    kb_layout = no
    follow_mouse = 1
    touchpad {
        natural_scroll = yes
    }
}

general {
    layout = dwindle
}

decoration {
    rounding = 8
    
    blur {
        enabled = false              # Blur is expensive, keep disabled for performance
    }
}

# Rendering settings for sharper display and performance
misc {
    disable_hyprland_logo = true
    disable_splash_rendering = true
    initial_workspace_tracking = 1
    vfr = true                           # Variable refresh rate (power saving)
    vrr = 1                              # Adaptive sync (for gaming monitor)
    mouse_move_enables_dpms = true       # Wake displays on mouse move
    key_press_enables_dpms = true        # Wake displays on key press
}

# XWayland settings for sharper rendering
xwayland {
    force_zero_scaling = true
}

# Environment variables for native Wayland rendering
env = ELECTRON_OZONE_PLATFORM_HINT,auto
env = MOZ_ENABLE_WAYLAND,1
env = GDK_BACKEND,wayland,x11
env = QT_QPA_PLATFORM,wayland;xcb
env = SDL_VIDEODRIVER,wayland
env = CLUTTER_BACKEND,wayland

animations {
    enabled = yes
    bezier = easeOutQuart, 0.25, 1, 0.5, 1
    
    animation = windows, 1, 3, easeOutQuart, slide
    animation = windowsOut, 1, 3, easeOutQuart, slide
    animation = border, 1, 5, default
    animation = fade, 1, 4, default
    animation = workspaces, 1, 3, easeOutQuart, slide
}

# Gestures configuration (uncomment if supported in your Hyprland version)
# gestures {
#     workspace_swipe = true
#     workspace_swipe_fingers = 3
# }

# Environment variables - ensure ~/.local/bin is in PATH
env = PATH,$HOME/.local/bin:$PATH
# GTK theme - dark mode
env = GTK_THEME,Adwaita-dark
env = GTK_THEME_NAME,Adwaita-dark

exec-once = ~/.local/bin/start-hyprpaper.sh
exec-once = waybar
exec-once = dunst
exec-once = wl-clip-persist --clipboard
exec-once = ~/.local/bin/start-cliphist.sh

# === KEYBINDS ===
bind = SUPER, SPACE, exec, tofi-drun --drun-launch=true
bind = SUPER, RETURN, exec, ghostty
bind = SUPER, Q, killactive
bind = SUPER, F, fullscreen, 0
bind = SUPER, TAB, cyclenext
bind = SUPER, S, exec, spotify

# Workspace bindings to monitors (using workspaceOpts in monitor config above)
# Additional explicit bindings for reliability
workspace = 1, monitor:DP-1, default:true
workspace = 2, monitor:DP-1
workspace = 3, monitor:DP-1
workspace = 4, monitor:DP-1
workspace = 5, monitor:DP-1
workspace = 6, monitor:DP-3, default:true
workspace = 7, monitor:DP-3
workspace = 8, monitor:DP-3
workspace = 9, monitor:DP-3

# Workspaces 1-9
bind = SUPER, 1, workspace, 1
bind = SUPER SHIFT, 1, movetoworkspace, 1
bind = SUPER, 2, workspace, 2
bind = SUPER SHIFT, 2, movetoworkspace, 2
bind = SUPER, 3, workspace, 3
bind = SUPER SHIFT, 3, movetoworkspace, 3
bind = SUPER, 4, workspace, 4
bind = SUPER SHIFT, 4, movetoworkspace, 4
bind = SUPER, 5, workspace, 5
bind = SUPER SHIFT, 5, movetoworkspace, 5
bind = SUPER, 6, workspace, 6
bind = SUPER SHIFT, 6, movetoworkspace, 6
bind = SUPER, 7, workspace, 7
bind = SUPER SHIFT, 7, movetoworkspace, 7
bind = SUPER, 8, workspace, 8
bind = SUPER SHIFT, 8, movetoworkspace, 8
bind = SUPER, 9, workspace, 9
bind = SUPER SHIFT, 9, movetoworkspace, 9

# Reset all workspaces to their assigned monitors
bind = SUPER CONTROL, R, exec, ~/.local/bin/reset-workspaces.sh
# Refresh wallpaper
bind = SUPER CONTROL, W, exec, ~/.local/bin/refresh-hyprpaper.sh

# Super+K: Keybind display
bind = SUPER, K, exec, bash ~/.config/hypr/hyprland-keys.conf

# Window navigation (Super + Arrow keys)
bind = SUPER, left, movefocus, l
bind = SUPER, right, movefocus, r
bind = SUPER, up, movefocus, u
bind = SUPER, down, movefocus, d

# Window movement (Super + Shift + Arrow keys) - move window to screen edges
bind = SUPER SHIFT, left, movewindow, l
bind = SUPER SHIFT, right, movewindow, r
bind = SUPER SHIFT, up, movewindow, u
bind = SUPER SHIFT, down, movewindow, d

# Super+M: Monitor management (TUI)
bind = SUPER, M, exec, ghostty --class hyprmon -e ~/.local/bin/hyprmon

# Super+B: Chromium browser (Personal/Default profile)
bind = SUPER, B, exec, chromium-browser --profile-directory=Default
# Super+Shift+B: Chromium browser (Work profile)
bind = SUPER SHIFT, B, exec, chromium-browser --profile-directory=Work

# Unified Clipboard (like Omarchy)
# Super+C: Copy primary selection to clipboard
bind = SUPER, C, exec, ~/.local/bin/clipboard-copy.sh
# Super+V: Show clipboard history and paste
bind = SUPER, V, exec, ~/.config/cliphist/cliphist-menu.sh

# Screenshots
# Super+Shift+S: Area selection screenshot
bind = SUPER SHIFT, S, exec, ~/.local/bin/screenshot-area.sh
# Super+Shift+F: Full screen screenshot
bind = SUPER SHIFT, F, exec, ~/.local/bin/screenshot-full.sh
# Super+Shift+W: Active window screenshot
bind = SUPER SHIFT, W, exec, ~/.local/bin/screenshot-window.sh

# Screen Recording
# Super+Shift+R: Toggle screen recording (start/stop)
bind = SUPER SHIFT, R, exec, ~/.local/bin/screenrecord.sh

# Multimedia Keys
# Volume (wpctl is part of WirePlumber/PipeWire on Fedora)
bindel = , XF86AudioRaiseVolume, exec, wpctl set-volume -l 1.5 @DEFAULT_AUDIO_SINK@ 5%+
bindel = , XF86AudioLowerVolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%-
bindl = , XF86AudioMute, exec, wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle
# Media Control
bindl = , XF86AudioPlay, exec, playerctl play-pause
bindl = , XF86AudioPrev, exec, playerctl previous
bindl = , XF86AudioNext, exec, playerctl next
# Brightness
bindel = , XF86MonBrightnessUp, exec, brightnessctl set 5%+
bindel = , XF86MonBrightnessDown, exec, brightnessctl set 5%-

# Dev tools
bind = SUPER, G, exec, ~/.local/bin/lazygit-launcher.sh
bind = SUPER, D, exec, ghostty --class=lazydocker --title=lazydocker -e lazydocker
bind = SUPER SHIFT, D, exec, ~/.local/bin/toggle-docker.sh
bind = SUPER, N, exec, ghostty --class nvim -e nvim
bind = SUPER, P, exec, ghostty --class python-project -e ~/.local/bin/python-project
bind = SUPER, O, exec, ghostty --class=opencode --title=opencode -e /home/ricfort/.opencode/bin/opencode

# Floating + centered
windowrulev2 = float, class:^(ghostty|opencode)$, title:^(lazygit|lazydocker|nvim|python-project|bluetuith|hyprmon|Docker Toggle|opencode)$
windowrulev2 = size 1200 800, class:^(ghostty|opencode)$, title:^(lazygit|lazydocker|nvim|bluetuith|hyprmon|opencode)$
windowrulev2 = size 600 200, class:^(ghostty)$, title:^(Docker Toggle)$
windowrulev2 = center, class:^(ghostty|opencode)$, title:^(lazygit|lazydocker|nvim|python-project|bluetuith|hyprmon|Docker Toggle|opencode)$

# WebApps - borderless, fullscreen-like experience (like Omarchy)
# Chromium with --app flag already removes window decorations, but ensure no Hyprland borders
# Match any window class that's not the default chromium-browser (webapps use custom classes)
windowrulev2 = noborder, class:^(chromium-browser|chromium)$, title:^(?!Chromium|New Tab|.* - Chromium).*$
windowrulev2 = rounding 0, class:^(chromium-browser|chromium)$, title:^(?!Chromium|New Tab|.* - Chromium).*$
