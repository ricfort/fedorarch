#!/usr/bin/env bash
set -euo pipefail

CONFIG_FILE="${HYPRLAND_CONFIG:-$HOME/.config/hypr/hyprland.conf}"

if [ ! -f "$CONFIG_FILE" ]; then
    echo "Error: Hyprland config not found at $CONFIG_FILE"
    exit 1
fi

if ! command -v tofi >/dev/null 2>&1; then
    echo "Error: tofi is not installed or not in PATH"
    exit 1
fi

binds=$(grep -E "^bind.*=" "$CONFIG_FILE" | \
        sed 's/bind.*=[ ]*\(.*\),[ ]*\(.*\)/\1 â†’ \2/' | sort)

if [ -z "$binds" ]; then
    echo "No keybinds found in config"
    exit 1
fi

echo "$binds" | tofi --prompt-text="" \
    --width=600 --height=800 --font="JetBrainsMono Nerd Font" \
    --font-size=12 \
    --background-color="#1e1e2e" --text-color="#cdd6f4"
